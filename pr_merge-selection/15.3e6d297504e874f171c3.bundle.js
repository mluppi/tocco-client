(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{3388:function(module,exports,__webpack_require__){var baseAssignValue=__webpack_require__(366),createAggregator=__webpack_require__(3389),hasOwnProperty=Object.prototype.hasOwnProperty,groupBy=createAggregator((function(result,value,key){hasOwnProperty.call(result,key)?result[key].push(value):baseAssignValue(result,key,[value])}));module.exports=groupBy},3389:function(module,exports,__webpack_require__){var arrayAggregator=__webpack_require__(3390),baseAggregator=__webpack_require__(3391),baseIteratee=__webpack_require__(364),isArray=__webpack_require__(147);module.exports=function createAggregator(setter,initializer){return function(collection,iteratee){var func=isArray(collection)?arrayAggregator:baseAggregator,accumulator=initializer?initializer():{};return func(collection,setter,baseIteratee(iteratee,2),accumulator)}}},3390:function(module,exports){module.exports=function arrayAggregator(array,setter,iteratee,accumulator){for(var index=-1,length=null==array?0:array.length;++index<length;){var value=array[index];setter(accumulator,value,iteratee(value),array)}return accumulator}},3391:function(module,exports,__webpack_require__){var baseEach=__webpack_require__(1045);module.exports=function baseAggregator(collection,setter,iteratee,accumulator){return baseEach(collection,(function(value,key,collection){setter(accumulator,value,iteratee(value),collection)})),accumulator}},3410:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);__webpack_require__(16),__webpack_require__(27),__webpack_require__(18),__webpack_require__(71),__webpack_require__(28),__webpack_require__(22),__webpack_require__(32),__webpack_require__(33),__webpack_require__(15),__webpack_require__(19);var defineProperty=__webpack_require__(4),defineProperty_default=__webpack_require__.n(defineProperty),react=__webpack_require__(0),react_default=__webpack_require__.n(react),reducer=__webpack_require__(23),appFactory=__webpack_require__(74),prop_types=__webpack_require__(11),prop_types_default=__webpack_require__.n(prop_types),root=__webpack_require__(99),es=__webpack_require__(36),index_es=__webpack_require__(13),taggedTemplateLiteral=__webpack_require__(25),taggedTemplateLiteral_default=__webpack_require__.n(taggedTemplateLiteral),styled_components_browser_esm=__webpack_require__(6),src=__webpack_require__(5),helpers_extends=(__webpack_require__(24),__webpack_require__(159),__webpack_require__(48),__webpack_require__(26),__webpack_require__(38),__webpack_require__(602),__webpack_require__(77),__webpack_require__(52),__webpack_require__(41)),extends_default=__webpack_require__.n(helpers_extends),toConsumableArray=__webpack_require__(30),toConsumableArray_default=__webpack_require__.n(toConsumableArray);function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var source,i=1;i<arguments.length;i++)source=null!=arguments[i]?arguments[i]:{},i%2?ownKeys(source,!0).forEach((function(key){defineProperty_default()(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(source).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}));return target}var getAllPaths=function(sourceData){return Object.keys(sourceData.entities[0].paths)},getAllRelations=function(sourceData){return toConsumableArray_default()(new Set(sourceData.relations.map((function(r){return r.relationName}))))},getAllPathsAndRelations=function(sourceData){return[].concat(toConsumableArray_default()(getAllPaths(sourceData)),toConsumableArray_default()(getAllRelations(sourceData)))},setSourceData=(prop_types_default.a.shape({entities:prop_types_default.a.arrayOf(prop_types_default.a.shape({key:prop_types_default.a.string.isRequired,model:prop_types_default.a.string.isRequired,paths:prop_types_default.a.objectOf(prop_types_default.a.shape({type:prop_types_default.a.string,writable:prop_types_default.a.bool,value:prop_types_default.a.any}))})).isRequired,relations:prop_types_default.a.arrayOf(prop_types_default.a.shape({entityKey:prop_types_default.a.string.isRequired,relationName:prop_types_default.a.string.isRequired,keys:prop_types_default.a.arrayOf(prop_types_default.a.string).isRequired})).isRequired,displays:prop_types_default.a.arrayOf(prop_types_default.a.shape({model:prop_types_default.a.string.isRequired,values:prop_types_default.a.arrayOf(prop_types_default.a.shape({key:prop_types_default.a.string.isRequired,display:prop_types_default.a.string.isRequired}))})).isRequired,labels:prop_types_default.a.objectOf(prop_types_default.a.string).isRequired,mergeStragegy:prop_types_default.a.shape({display:prop_types_default.a.string})}),function(sourceData){return{type:"merge/SET_SOURCE_DATA",payload:{sourceData:sourceData}}}),actions_setTargetEntity=function(entityKey){return{type:"merge/SET_TARGET_ENTITY",payload:{entityKey:entityKey}}},get=(__webpack_require__(103),__webpack_require__(111),__webpack_require__(29)),get_default=__webpack_require__.n(get),js=(__webpack_require__(72),__webpack_require__(140)),areEqual=function(prevProps,nextProps){return 0===Object.keys(js.a.difference(prevProps,nextProps)).length},Selection_ref2=react_default.a.createElement(index_es.FormattedMessage,{id:"client.merge.allRelations"}),ManyRelationsCheckBox=react_default.a.memo((function(_ref){var entityData=_ref.entityData,entityKey=_ref.entityKey,name=_ref.name,setSelectedMultipleAll=_ref.setSelectedMultipleAll,isSelected=_ref.isSelected;return 0===entityData.value.length?null:react_default.a.createElement(react_default.a.Fragment,null,react_default.a.createElement("input",{type:"checkbox",onChange:function onChange(e){return setSelectedMultipleAll(name,entityKey,e.target.checked)},checked:isSelected,id:"".concat(name).concat(entityKey)}),react_default.a.createElement(src.K.Label,{for:"".concat(name).concat(entityKey)},Selection_ref2," (",entityData.value.length,")"))}),areEqual),RelationsCheckBoxes=react_default.a.memo((function(_ref3){var entityData=_ref3.entityData,entityKey=_ref3.entityKey,name=_ref3.name,setSelectedMultiple=_ref3.setSelectedMultiple,selectedMultiple=_ref3.selectedMultiple;return entityData.value.map((function(relationEntity){var isSelected=get_default()(selectedMultiple,[name,relationEntity.key])===entityKey;return react_default.a.createElement("div",{key:"relation-checkbox-".concat(relationEntity.key)},react_default.a.createElement("input",{type:"checkbox",onChange:function onChange(e){return setSelectedMultiple(name,entityKey,relationEntity.key,e.target.checked)},checked:isSelected,id:"".concat(name).concat(entityKey,"-").concat(relationEntity.key)}),react_default.a.createElement(src.K.Label,{for:"".concat(name).concat(entityKey,"-").concat(relationEntity.key)},react_default.a.createElement(src.i,{type:"single-select",value:relationEntity})))}))}),areEqual),FormattedValueRadio=react_default.a.memo((function(_ref4){var entityData=_ref4.entityData,entityKey=_ref4.entityKey,name=_ref4.name,setSelectedSingle=_ref4.setSelectedSingle,isSelected=_ref4.isSelected,type=entityData.type,writable=entityData.writable,mappedType={entity:"single-select"}[type]||type;return react_default.a.createElement(react_default.a.Fragment,null,react_default.a.createElement("input",{type:"radio",name:name,onChange:function onChange(){setSelectedSingle(name,entityKey)},checked:isSelected,id:"".concat(name).concat(entityKey),disabled:!writable}),react_default.a.createElement(src.K.Label,{for:"".concat(name).concat(entityKey)},react_default.a.createElement(src.i,{type:mappedType,value:entityData.value})))}),areEqual),CellRender_CellRenderer=function(_ref){var rowData=_ref.rowData,column=_ref.column,setSelectedSingle=_ref.setSelectedSingle,selectedSingle=_ref.selectedSingle,setSelectedMultiple=_ref.setSelectedMultiple,selectedMultiple=_ref.selectedMultiple,setSelectedMultipleAll=_ref.setSelectedMultipleAll,selectedMultipleAll=_ref.selectedMultipleAll,entityKey=column.entityKey,entityData=rowData[entityKey],type=entityData.type,name=rowData.__key;return"relations"===type?react_default.a.createElement(ManyRelationsCheckBox,{entityData:entityData,entityKey:entityKey,name:name,setSelectedMultipleAll:setSelectedMultipleAll,isSelected:get_default()(selectedMultipleAll,[name],[]).includes(entityKey)}):"entity-list"===type?react_default.a.createElement(RelationsCheckBoxes,{entityData:entityData,entityKey:entityKey,name:name,setSelectedMultiple:setSelectedMultiple,selectedMultiple:selectedMultiple}):react_default.a.createElement(FormattedValueRadio,{entityData:entityData,entityKey:entityKey,name:name,setSelectedSingle:setSelectedSingle,isSelected:selectedSingle[name]===entityKey})};CellRender_CellRenderer.displayName="CellRenderer";var mapActionCreatorsCell={setSelectedSingle:function(name,entityKey){return{type:"merge/SET_SELECTED_SINGLE",payload:{name:name,entityKey:entityKey}}},setSelectedMultiple:function(name,entityKey,relatedEntityKey,isSelected){return{type:"merge/SET_SELECTED_MULTIPLE",payload:{name:name,entityKey:entityKey,relatedEntityKey:relatedEntityKey,isSelected:isSelected}}},setSelectedMultipleAll:function(name,entityKey,isSelected){return{type:"merge/SET_SELECTED_MULTIPLE_ALL",payload:{name:name,entityKey:entityKey,isSelected:isSelected}}}},CellRendererContainer=Object(es.connect)((function(state){return{selectedSingle:state.merge.selected.single,selectedMultiple:state.merge.selected.multiple,selectedMultipleAll:state.merge.selected.multipleAll}}),mapActionCreatorsCell)(Object(index_es.injectIntl)(CellRender_CellRenderer));CellRender_CellRenderer.__docgenInfo={description:"",methods:[],displayName:"CellRenderer",props:{rowData:{type:{name:"objectOf",value:{name:"union",value:[{name:"shape",value:{value:{name:"any",required:!1},type:{name:"string",required:!1}}},{name:"string"}]}},required:!1,description:""},column:{type:{name:"shape",value:{entityKey:{name:"string",required:!0}}},required:!1,description:""},setSelectedSingle:{type:{name:"func"},required:!0,description:""},selectedSingle:{type:{name:"objectOf",value:{name:"string"}},required:!1,description:""},setSelectedMultiple:{type:{name:"func"},required:!0,description:""},selectedMultiple:{type:{name:"objectOf",value:{name:"objectOf",value:{name:"string"}}},required:!1,description:""},setSelectedMultipleAll:{type:{name:"func"},required:!0,description:""},selectedMultipleAll:{type:{name:"objectOf",value:{name:"arrayOf",value:{name:"string"}}},required:!1,description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/merge/src/components/MergeTable/CellRender.js"]={name:"CellRenderer",docgenInfo:CellRender_CellRenderer.__docgenInfo,path:"packages/merge/src/components/MergeTable/CellRender.js"});var MergeTable_LabelCellRenderer=function(_ref){var rowIdx=_ref.rowIdx,sourceData=_ref.sourceData,columnName=_ref.allPaths[rowIdx];return react_default.a.createElement(src.K.B,null,sourceData.labels[columnName])};MergeTable_LabelCellRenderer.displayName="LabelCellRenderer";var mapActionCreatorsColumn={setTargetEntity:actions_setTargetEntity},ColumnHeaderRendererContainer=Object(es.connect)((function(state){return{targetEntity:state.merge.selected.targetEntity,mergeStrategyDisplay:state.merge.sourceData.mergeStrategyDisplay}}),mapActionCreatorsColumn)(Object(index_es.injectIntl)((function(_ref2){var label=_ref2.label,entityKey=_ref2.entityKey,setTargetEntity=_ref2.setTargetEntity,targetEntity=_ref2.targetEntity,mergeStrategyDisplay=_ref2.mergeStrategyDisplay,intl=_ref2.intl,isChecked=targetEntity===entityKey,status=isChecked?function msg(id){return intl.formatMessage({id:id})}("client.merge.strategy.keep"):mergeStrategyDisplay;return react_default.a.createElement(react_default.a.Fragment,null,react_default.a.createElement("input",{type:"radio",name:"column",onChange:function onChange(){return setTargetEntity(entityKey)},checked:isChecked,id:"targetEntity".concat(entityKey)}),react_default.a.createElement(src.K.Label,{for:"targetEntity".concat(entityKey)}," ",label," (",status,")"))}))),MergeTable_ref4=react_default.a.createElement(index_es.FormattedMessage,{id:"client.merge.saveButton"}),MergeTable=function(_ref3){var sourceData=_ref3.sourceData,executeMerge=_ref3.executeMerge,data=Object(react.useMemo)((function(){return sourceData?function(sourceData){var pathRows=getAllPaths(sourceData).map((function(path){return sourceData.entities.reduce((function(acc,e){var value=e.paths[path];if(value&&value.value){if("entity"===value.type){var display=sourceData.displays.find((function(d){return d.model===value.value.model})).values.find((function(v){return v.key===value.value.key})).display;value.value.display=display}"entity-list"===value.type&&(value.value=value.value.map((function(f){var display=sourceData.displays.find((function(d){return d.model===f.model})).values.find((function(v){return v.key===f.key}));return f.display=void 0===display?"PK: "+f.key:display.display,f})))}return _objectSpread({},acc,defineProperty_default()({},e.key,value))}),{__key:path})})),relationRows=getAllRelations(sourceData).map((function(relation){return sourceData.relations.filter((function(r){return r.relationName===relation})).reduce((function(acc,val){return _objectSpread({},acc,defineProperty_default()({},val.entityKey,{type:"relations",value:val.keys}))}),{__key:relation})}));return[].concat(toConsumableArray_default()(pathRows),toConsumableArray_default()(relationRows))}(sourceData):[]}),[sourceData]),columns=Object(react.useMemo)((function(){return sourceData?function(sourceData,ColumnHeaderRenderer,PathCellRenderer,LabelCellRenderer){var pathColumns=sourceData.entities.map((function(entity){return{id:entity.key,entityKey:entity.key,resizable:!0,sorting:{sortable:!1},CellRenderer:PathCellRenderer,HeaderRenderer:function HeaderRenderer(props){return react_default.a.createElement(ColumnHeaderRenderer,extends_default()({},props,{entityKey:entity.key,label:sourceData.displays.find((function(d){return d.model===entity.model})).values.find((function(v){return v.key===entity.key})).display}))}}}));return[{id:"column-label",label:"",resizable:!0,sorting:{sortable:!1},CellRenderer:function CellRenderer(props){return react_default.a.createElement(LabelCellRenderer,extends_default()({},props,{sourceData:sourceData,allPaths:getAllPathsAndRelations(sourceData)}))}}].concat(toConsumableArray_default()(pathColumns))}(sourceData,ColumnHeaderRendererContainer,CellRendererContainer,MergeTable_LabelCellRenderer):[]}),[sourceData]);return react_default.a.createElement(react_default.a.Fragment,null,react_default.a.createElement(src.d,{onClick:executeMerge,look:"raised",ink:"primary"},MergeTable_ref4),react_default.a.createElement(src.J,{columns:columns,data:data,selectionStyle:"none",dataLoadingInProgress:null===sourceData,onColumnPositionChange:function onColumnPositionChange(){}}))};MergeTable.__docgenInfo={description:"",methods:[],displayName:"MergeTable",props:{sourceData:{type:{name:"custom",raw:"sourceDataPropType"},required:!1,description:""},executeMerge:{type:{name:"func"},required:!0,description:""}}};var MergeTable_MergeTable=MergeTable;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/merge/src/components/MergeTable/MergeTable.js"]={name:"MergeTable",docgenInfo:MergeTable.__docgenInfo,path:"packages/merge/src/components/MergeTable/MergeTable.js"});var mapActionCreators={executeMerge:function(){return{type:"merge/EXECUTE_MERGE"}}},components_MergeTable=Object(es.connect)((function(state){return{sourceData:state.merge.sourceData}}),mapActionCreators)(Object(index_es.injectIntl)(MergeTable_MergeTable)),slicedToArray=(__webpack_require__(117),__webpack_require__(154),__webpack_require__(58)),slicedToArray_default=__webpack_require__.n(slicedToArray),groupBy=__webpack_require__(3388),groupBy_default=__webpack_require__.n(groupBy),_ref6=react_default.a.createElement("br",null),_ref7=react_default.a.createElement("br",null),MergeSummary=function(_ref){var mergeResponse=_ref.mergeResponse,intl=_ref.intl,msg=function(id){return intl.formatMessage({id:id})},notCopiedRelations=Object.entries(groupBy_default()(mergeResponse.body.notCopiedRelations,(function(e){return e.entityLabel}))).map((function(_ref2){var _ref3=slicedToArray_default()(_ref2,2),entityLabel=_ref3[0],list=_ref3[1];return"".concat(entityLabel," (").concat(list.length,")")})).join(", "),notDeletedEntities=Object.entries(groupBy_default()(mergeResponse.body.notDeletedEntities,(function(e){return e.entityLabel}))).map((function(_ref4){var _ref5=slicedToArray_default()(_ref4,2),entityLabel=_ref5[0],list=_ref5[1];return"".concat(entityLabel," (").concat(list.length,")")})).join(", ");return react_default.a.createElement(react_default.a.Fragment,null,react_default.a.createElement(src.K.P,null,msg("client.merge.summary.success"),(0<mergeResponse.body.notCopiedRelations.length||0<mergeResponse.body.notDeletedEntities.length)&&msg("client.merge.summary.successHint")),0<mergeResponse.body.notCopiedRelations.length&&react_default.a.createElement(src.K.P,null,msg("client.merge.summary.notCopiedRelations"),":",_ref6,notCopiedRelations),0<mergeResponse.body.notDeletedEntities.length&&react_default.a.createElement(src.K.P,null,msg("client.merge.summary.notDeletedEntities"),":",_ref7,notDeletedEntities),mergeResponse.body.showPermissionMessage&&react_default.a.createElement(src.K.P,null,msg("client.merge.summary.permission")))};MergeSummary.__docgenInfo={description:"",methods:[],displayName:"MergeSummary",props:{mergeResponse:{type:{name:"object"},required:!1,description:""},intl:{type:{name:"custom",raw:"intlShape"},required:!1,description:""}}};var MergeSummary_MergeSummary=MergeSummary;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/merge/src/components/MergeSummary/MergeSummary.js"]={name:"MergeSummary",docgenInfo:MergeSummary.__docgenInfo,path:"packages/merge/src/components/MergeSummary/MergeSummary.js"});var components_MergeSummary=Object(es.connect)((function(state){return{mergeResponse:state.merge.mergeResponse}}),{})(Object(index_es.injectIntl)(MergeSummary_MergeSummary));function _templateObject(){var data=taggedTemplateLiteral_default()(["\n  margin: 5px;\n  height: 100%;\n  overflow: hidden;\n"]);return _templateObject=function(){return data},data}var StyledMerge=styled_components_browser_esm.default.div(_templateObject()),Merge_ref2=react_default.a.createElement(components_MergeSummary,null),Merge_ref3=react_default.a.createElement(components_MergeTable,null),Merge=function(_ref){var initialize=_ref.initialize,mergeResponse=_ref.mergeResponse;return Object(react.useEffect)((function(){initialize()}),[]),react_default.a.createElement(StyledMerge,null,mergeResponse?Merge_ref2:Merge_ref3)};Merge.displayName="Merge",Merge.__docgenInfo={description:"",methods:[],displayName:"Merge",props:{initialize:{type:{name:"func"},required:!0,description:""},mergeResponse:{type:{name:"object"},required:!1,description:""}}};var Merge_Merge=Merge;"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/merge/src/components/Merge/Merge.js"]={name:"Merge",docgenInfo:Merge.__docgenInfo,path:"packages/merge/src/components/Merge/Merge.js"});var MergeContainer_mapActionCreators={initialize:function(){return{type:"merge/INITIALIZE"}}},components_Merge=Object(es.connect)((function(state){return{mergeResponse:state.merge.mergeResponse}}),MergeContainer_mapActionCreators)(Object(index_es.injectIntl)(Merge_Merge)),regenerator=__webpack_require__(2),regenerator_default=__webpack_require__.n(regenerator),redux_saga_effects_npm_proxy_esm=(__webpack_require__(40),__webpack_require__(1)),rest=__webpack_require__(31),uniq=__webpack_require__(199),uniq_default=__webpack_require__.n(uniq),_marked=regenerator_default.a.mark(mainSagas),_marked2=regenerator_default.a.mark(sagas_initialize),_marked3=regenerator_default.a.mark(getSelection),_marked4=regenerator_default.a.mark(loadSourceData),_marked5=regenerator_default.a.mark(getMergeBody),_marked6=regenerator_default.a.mark(sagas_executeMerge),mergeSelector=function(state){return state.merge};function mainSagas(){return regenerator_default.a.wrap((function(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,Object(redux_saga_effects_npm_proxy_esm.a)([Object(redux_saga_effects_npm_proxy_esm.j)("merge/INITIALIZE",sagas_initialize),Object(redux_saga_effects_npm_proxy_esm.j)("merge/EXECUTE_MERGE",sagas_executeMerge)]);case 2:case"end":return _context.stop()}}),_marked)}function sagas_initialize(){var _ref,selection;return regenerator_default.a.wrap((function(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.next=2,Object(redux_saga_effects_npm_proxy_esm.f)(mergeSelector);case 2:return _ref=_context2.sent,selection=_ref.selection,_context2.next=6,Object(redux_saga_effects_npm_proxy_esm.b)(loadSourceData,selection);case 6:case"end":return _context2.stop()}}),_marked2)}function getSelection(selection){return regenerator_default.a.wrap((function(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:return _context3.abrupt("return",{model:selection.entityName,keys:selection.ids});case 1:case"end":return _context3.stop()}}),_marked3)}function loadSourceData(selection){var resource,options,response,sourceData;return regenerator_default.a.wrap((function(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:return resource="merge/sourceData",_context4.next=3,Object(redux_saga_effects_npm_proxy_esm.b)(getSelection,selection);case 3:return _context4.t0=_context4.sent,options={method:"POST",body:_context4.t0},_context4.next=7,Object(redux_saga_effects_npm_proxy_esm.b)(rest.a.requestSaga,resource,options);case 7:return response=_context4.sent,sourceData=response.body,_context4.next=11,Object(redux_saga_effects_npm_proxy_esm.e)(setSourceData(sourceData));case 11:return _context4.next=13,Object(redux_saga_effects_npm_proxy_esm.e)(actions_setTargetEntity(sourceData.entities[0].key));case 13:case"end":return _context4.stop()}}),_marked4)}function getMergeBody(){var _ref2,selection,selected,sourceData,paths,_loop,_i,_Object$entries,_loop2,_i2,_Object$entries2,mergeRelations;return regenerator_default.a.wrap((function(_context5){for(;;)switch(_context5.prev=_context5.next){case 0:return _context5.next=2,Object(redux_saga_effects_npm_proxy_esm.f)(mergeSelector);case 2:for(_ref2=_context5.sent,selection=_ref2.selection,selected=_ref2.selected,sourceData=_ref2.sourceData,paths={},_loop=function(){var _Object$entries$_i=slicedToArray_default()(_Object$entries[_i],2),name=_Object$entries$_i[0],entityKey=_Object$entries$_i[1],path=sourceData.entities.find((function(e){return e.key===entityKey})).paths[name];path.writable&&("entity"===path.type?null===path.value?paths[name]=null:paths[name]={key:path.value.key}:paths[name]=entityKey)},_i=0,_Object$entries=Object.entries(selected.single);_i<_Object$entries.length;_i++)_loop();for(_loop2=function(){var _Object$entries2$_i=slicedToArray_default()(_Object$entries2[_i2],2),name=_Object$entries2$_i[0],obj=_Object$entries2$_i[1];paths[name]=[],Object.keys(obj).forEach((function(value){return paths[name].push({key:value})}))},_i2=0,_Object$entries2=Object.entries(selected.multiple);_i2<_Object$entries2.length;_i2++)_loop2();return mergeRelations=uniq_default()(sourceData.relations.map((function(r){return r.relationName}))).map((function(relationName){return{relationName:relationName,sourceKey:selected.multipleAll[relationName]||[]}})),_context5.next=14,Object(redux_saga_effects_npm_proxy_esm.b)(getSelection,selection);case 14:return _context5.t0=_context5.sent,_context5.t1={key:selected.targetEntity,paths:paths},_context5.t2=mergeRelations,_context5.abrupt("return",{selection:_context5.t0,targetEntity:_context5.t1,mergeRelations:_context5.t2});case 18:case"end":return _context5.stop()}}),_marked5)}function sagas_executeMerge(){var resource,options,response;return regenerator_default.a.wrap((function(_context6){for(;;)switch(_context6.prev=_context6.next){case 0:return resource="merge/merge",_context6.next=3,Object(redux_saga_effects_npm_proxy_esm.b)(getMergeBody);case 3:return _context6.t0=_context6.sent,options={method:"POST",body:_context6.t0},_context6.next=7,Object(redux_saga_effects_npm_proxy_esm.b)(rest.a.requestSaga,resource,options);case 7:return response=_context6.sent,_context6.next=10,Object(redux_saga_effects_npm_proxy_esm.e)({type:"merge/SET_MERGE_RESPONSE",payload:{mergeResponse:response}});case 10:case"end":return _context6.stop()}}),_marked6)}var _ACTION_HANDLERS,omit=__webpack_require__(190),omit_default=__webpack_require__.n(omit);function reducer_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function reducer_objectSpread(target){for(var source,i=1;i<arguments.length;i++)source=null!=arguments[i]?arguments[i]:{},i%2?reducer_ownKeys(source,!0).forEach((function(key){defineProperty_default()(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):reducer_ownKeys(source).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}));return target}var ACTION_HANDLERS=(_ACTION_HANDLERS={},defineProperty_default()(_ACTION_HANDLERS,"merge/SET_SELECTION",reducer.a.singleTransferReducer("selection")),defineProperty_default()(_ACTION_HANDLERS,"merge/SET_SOURCE_DATA",reducer.a.singleTransferReducer("sourceData")),defineProperty_default()(_ACTION_HANDLERS,"merge/SET_MERGE_RESPONSE",reducer.a.singleTransferReducer("mergeResponse")),defineProperty_default()(_ACTION_HANDLERS,"merge/SET_SELECTED_SINGLE",(function(state,_ref){var _ref$payload=_ref.payload,name=_ref$payload.name,entityKey=_ref$payload.entityKey;return reducer_objectSpread({},state,{selected:reducer_objectSpread({},state.selected,{single:reducer_objectSpread({},state.selected.single,defineProperty_default()({},name,entityKey))})})})),defineProperty_default()(_ACTION_HANDLERS,"merge/SET_SELECTED_MULTIPLE",(function(state,_ref2){var multiple,_ref2$payload=_ref2.payload,name=_ref2$payload.name,entityKey=_ref2$payload.entityKey,relatedEntityKey=_ref2$payload.relatedEntityKey;return _ref2$payload.isSelected?multiple=reducer_objectSpread({},state.selected.multiple,defineProperty_default()({},name,reducer_objectSpread({},state.selected.multiple[name],defineProperty_default()({},relatedEntityKey,entityKey)))):(multiple=reducer_objectSpread({},state.selected.multiple))[name]=omit_default()(multiple[name],[relatedEntityKey]),reducer_objectSpread({},state,{selected:reducer_objectSpread({},state.selected,{multiple:multiple})})})),defineProperty_default()(_ACTION_HANDLERS,"merge/SET_SELECTED_MULTIPLE_ALL",(function(state,_ref3){var array,_ref3$payload=_ref3.payload,name=_ref3$payload.name,entityKey=_ref3$payload.entityKey;return array=_ref3$payload.isSelected?[].concat(toConsumableArray_default()(state.selected.multipleAll[name]||[]),[entityKey]):state.selected.multipleAll[name].filter((function(key){return key!==entityKey})),reducer_objectSpread({},state,{selected:reducer_objectSpread({},state.selected,{multipleAll:reducer_objectSpread({},state.selected.multipleAll,defineProperty_default()({},name,array))})})})),defineProperty_default()(_ACTION_HANDLERS,"merge/SET_TARGET_ENTITY",(function(state,_ref4){for(var entityKey=_ref4.payload.entityKey,single={},multiple={},paths=state.sourceData.entities.find((function(e){return e.key===entityKey})).paths,_loop=function(){var _Object$entries$_i=slicedToArray_default()(_Object$entries[_i],2),key=_Object$entries$_i[0],obj=_Object$entries$_i[1];"entity-list"===obj.type?(multiple[key]={},obj.value.map((function(e){return e.key})).forEach((function(relatedEntityKey){multiple[key][relatedEntityKey]=entityKey}))):single[key]=entityKey},_i=0,_Object$entries=Object.entries(paths);_i<_Object$entries.length;_i++)_loop();var multipleAll=state.sourceData.relations.filter((function(e){return e.entityKey===entityKey&&0<e.keys.length})).reduce((function(acc,val){return reducer_objectSpread({},acc,defineProperty_default()({},val.relationName,[entityKey]))}),{});return reducer_objectSpread({},state,{selected:reducer_objectSpread({},state.selected,{targetEntity:entityKey,single:single,multiple:multiple,multipleAll:multipleAll})})})),_ACTION_HANDLERS),initialState={selection:null,sourceData:null,mergeResponse:null,selected:{targetEntity:null,single:{},multiple:{},multipleAll:{}}};function reducer_reducer(){var state=0<arguments.length&&void 0!==arguments[0]?arguments[0]:initialState,action=1<arguments.length?arguments[1]:void 0,handler=ACTION_HANDLERS[action.type];return handler?handler(state,action):state}reducer_reducer.__docgenInfo={description:"",methods:[],displayName:"reducer"},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/merge/src/modules/merge/reducer.js"]={name:"reducer",docgenInfo:reducer_reducer.__docgenInfo,path:"packages/merge/src/modules/merge/reducer.js"});var merge_marked=regenerator_default.a.mark(sagas);function sagas(){return regenerator_default.a.wrap((function(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,Object(redux_saga_effects_npm_proxy_esm.a)([Object(redux_saga_effects_npm_proxy_esm.d)(mainSagas)]);case 2:case"end":return _context.stop()}}),merge_marked)}var reducers={merge:reducer_reducer},reducers_sagas=[sagas];function main_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}var EXTERNAL_EVENTS=["emitAction"],main_ref=react_default.a.createElement(components_Merge,null),initApp=function(id,input,events,publicPath){var selection,store=appFactory.a.createStore(reducers,reducers_sagas,input,"merge");return appFactory.a.createApp("merge",main_ref,store,{input:input,events:events,actions:[(selection=input.selection,{type:"merge/SET_SELECTION",payload:{selection:selection}})],publicPath:publicPath,textResourceModules:["component","common","merge"]})};appFactory.a.registerAppInRegistry("merge",initApp);var MergeApp=function(props){var events=EXTERNAL_EVENTS.reduce((function(events,event){return props[event]&&(events[event]=props[event]),events}),{});return initApp(0,props,events).component};MergeApp.propTypes=function main_objectSpread(target){for(var source,i=1;i<arguments.length;i++)source=null!=arguments[i]?arguments[i]:{},i%2?main_ownKeys(source,!0).forEach((function(key){defineProperty_default()(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):main_ownKeys(source).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}));return target}({selection:prop_types_default.a.object},EXTERNAL_EVENTS.reduce((function(propTypes,event){return propTypes[event]=prop_types_default.a.func,propTypes}),{}));__webpack_exports__.default=Object(root.hot)(MergeApp)}}]);
//# sourceMappingURL=15.3e6d297504e874f171c3.bundle.js.map