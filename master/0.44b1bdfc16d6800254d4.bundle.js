(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{2e3:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"k",function(){return SET_FORM_DEFINITION}),__webpack_require__.d(__webpack_exports__,"b",function(){return LOAD_DETAIL_VIEW}),__webpack_require__.d(__webpack_exports__,"f",function(){return SET_ENTITY}),__webpack_require__.d(__webpack_exports__,"p",function(){return SUBMIT_FORM}),__webpack_require__.d(__webpack_exports__,"m",function(){return SET_LAST_SAVE}),__webpack_require__.d(__webpack_exports__,"h",function(){return SET_ENTITY_MODEL}),__webpack_require__.d(__webpack_exports__,"r",function(){return UNLOAD_DETAIL_VIEW}),__webpack_require__.d(__webpack_exports__,"a",function(){return FIRE_TOUCHED}),__webpack_require__.d(__webpack_exports__,"o",function(){return SET_TOUCHED}),__webpack_require__.d(__webpack_exports__,"i",function(){return SET_ENTITY_NAME}),__webpack_require__.d(__webpack_exports__,"g",function(){return SET_ENTITY_ID}),__webpack_require__.d(__webpack_exports__,"n",function(){return SET_MODE}),__webpack_require__.d(__webpack_exports__,"l",function(){return SET_FORM_NAME}),__webpack_require__.d(__webpack_exports__,"d",function(){return SET_APP_ID}),__webpack_require__.d(__webpack_exports__,"q",function(){return TOUCH_ALL_FIELDS}),__webpack_require__.d(__webpack_exports__,"e",function(){return SET_DEFAULT_VALUES}),__webpack_require__.d(__webpack_exports__,"c",function(){return NAVIGATE_TO_CREATE}),__webpack_require__.d(__webpack_exports__,"j",function(){return SET_FIELD_DEFINITIONS}),__webpack_require__.d(__webpack_exports__,"C",function(){return setFormDefinition}),__webpack_require__.d(__webpack_exports__,"t",function(){return loadDetailView}),__webpack_require__.d(__webpack_exports__,"x",function(){return setEntity}),__webpack_require__.d(__webpack_exports__,"H",function(){return submitForm}),__webpack_require__.d(__webpack_exports__,"E",function(){return setLastSave}),__webpack_require__.d(__webpack_exports__,"z",function(){return setEntityModel}),__webpack_require__.d(__webpack_exports__,"J",function(){return unloadDetailView}),__webpack_require__.d(__webpack_exports__,"s",function(){return fireTouched}),__webpack_require__.d(__webpack_exports__,"G",function(){return setTouched}),__webpack_require__.d(__webpack_exports__,"A",function(){return setEntityName}),__webpack_require__.d(__webpack_exports__,"y",function(){return setEntityId}),__webpack_require__.d(__webpack_exports__,"F",function(){return setMode}),__webpack_require__.d(__webpack_exports__,"D",function(){return setFormName}),__webpack_require__.d(__webpack_exports__,"v",function(){return setAppId}),__webpack_require__.d(__webpack_exports__,"I",function(){return touchAllFields}),__webpack_require__.d(__webpack_exports__,"w",function(){return setDefaultValues}),__webpack_require__.d(__webpack_exports__,"u",function(){return navigateToCreate}),__webpack_require__.d(__webpack_exports__,"B",function(){return setFieldDefinitions});__webpack_require__(378),__webpack_require__(101);var SET_FORM_DEFINITION="entityDetail/SET_FORM_DEFINITION",LOAD_DETAIL_VIEW="entityDetail/LOAD_DETAIL_VIEW",SET_ENTITY="entityDetail/SET_ENTITY",SUBMIT_FORM="entityDetail/SUBMIT_FORM",SET_LAST_SAVE="entityDetail/SET_LAST_SAVE",SET_ENTITY_MODEL="entityDetail/SET_ENTITY_MODEL",UNLOAD_DETAIL_VIEW="entityDetail/UNLOAD_DETAIL_VIEW",FIRE_TOUCHED="entityDetail/FIRE_TOUCHED",SET_TOUCHED="entityDetail/SET_TOUCHED",SET_ENTITY_NAME="entityDetail/SET_ENTITY_NAME",SET_ENTITY_ID="entityDetail/SET_ENTITY_ID",SET_MODE="entityDetail/SET_MODE",SET_FORM_NAME="entityDetail/SET_FORM_NAME",SET_APP_ID="entityDetail/SET_APP_ID",TOUCH_ALL_FIELDS="entityDetail/TOCH_ALL_FIELDS",SET_DEFAULT_VALUES="entityDetail/SET_DEFAULT_VALUES",NAVIGATE_TO_CREATE="entityDetail/NAVIGATE_TO_CREATE",SET_FIELD_DEFINITIONS="entityDetail/SET_FIELD_DEFINITIONS",setFormDefinition=function(formDefinition){return{type:SET_FORM_DEFINITION,payload:{formDefinition:formDefinition}}},loadDetailView=function(modelPaths,entityId){return{type:LOAD_DETAIL_VIEW,payload:{modelPaths:modelPaths,entityId:entityId}}},setEntity=function(entity){return{type:SET_ENTITY,payload:{entity:entity}}},submitForm=function(){return{type:SUBMIT_FORM}},setLastSave=function(){var lastSave=0<arguments.length&&void 0!==arguments[0]?arguments[0]:Date.now();return{type:SET_LAST_SAVE,payload:{lastSave:lastSave}}},setEntityModel=function(entityModel){return{type:SET_ENTITY_MODEL,payload:{entityModel:entityModel}}},unloadDetailView=function(){return{type:UNLOAD_DETAIL_VIEW}},fireTouched=function(touched){return{type:FIRE_TOUCHED,payload:{touched:touched}}},setTouched=function(touched){return{type:SET_TOUCHED,payload:{touched:touched}}},setEntityName=function(entityName){return{type:SET_ENTITY_NAME,payload:{entityName:entityName}}},setEntityId=function(entityId){return{type:SET_ENTITY_ID,payload:{entityId:entityId}}},setMode=function(mode){return{type:SET_MODE,payload:{mode:mode}}},setFormName=function(formName){return{type:SET_FORM_NAME,payload:{formName:formName}}},setAppId=function(appId){return{type:SET_APP_ID,payload:{appId:appId}}},touchAllFields=function(){return{type:TOUCH_ALL_FIELDS}},setDefaultValues=function(defaultValues){return{type:SET_DEFAULT_VALUES,payload:{defaultValues:defaultValues}}},navigateToCreate=function(relationName){return{type:NAVIGATE_TO_CREATE,payload:{relationName:relationName}}},setFieldDefinitions=function(fieldDefinitions){return{type:SET_FIELD_DEFINITIONS,payload:{fieldDefinitions:fieldDefinitions}}}},2001:function(module,__webpack_exports__,__webpack_require__){"use strict";(function(module){__webpack_require__(81);var _babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(49),_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_1__),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(53),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_2__),_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(50),_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_3__),_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(51),_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_4__),_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(52),_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_5__),react__WEBPACK_IMPORTED_MODULE_7__=(__webpack_require__(11),__webpack_require__(0)),react__WEBPACK_IMPORTED_MODULE_7___default=__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_7__),react_hot_loader_root__WEBPACK_IMPORTED_MODULE_9__=(__webpack_require__(34),__webpack_require__(103)),tocco_app_extensions_src_appFactory__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(80),tocco_app_extensions_src_notifier__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(57),tocco_app_extensions_src_errorLogging__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(116),tocco_app_extensions_src_actionEmitter__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(134),tocco_app_extensions_src_externalEvents__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(75),tocco_app_extensions_src_actions__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(138),tocco_app_extensions_src_formData__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(250),tocco_app_extensions_src_keyDown__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(445),tocco_simple_form_src_main__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__(952),tocco_entity_list_src_main__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__(607),_modules_reducers__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__(2059),_containers_DetailViewContainer__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__(2057),_input__WEBPACK_IMPORTED_MODULE_22__=__webpack_require__(2032),_customActions__WEBPACK_IMPORTED_MODULE_23__=__webpack_require__(2033),_shortcuts__WEBPACK_IMPORTED_MODULE_24__=__webpack_require__(2034),EXTERNAL_EVENTS=["onSubGridRowClick","onEntityCreated","onTouchedChange","emitAction","onNavigateToCreate"],_ref=react__WEBPACK_IMPORTED_MODULE_7___default.a.createElement(_containers_DetailViewContainer__WEBPACK_IMPORTED_MODULE_21__.a,null),initApp=function(id,input){var events=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},publicPath=3<arguments.length?arguments[3]:void 0,store=tocco_app_extensions_src_appFactory__WEBPACK_IMPORTED_MODULE_10__.a.createStore(_modules_reducers__WEBPACK_IMPORTED_MODULE_20__.a,_modules_reducers__WEBPACK_IMPORTED_MODULE_20__.b,input,"entity-detail");tocco_app_extensions_src_externalEvents__WEBPACK_IMPORTED_MODULE_14__.a.addToStore(store,events),tocco_app_extensions_src_actionEmitter__WEBPACK_IMPORTED_MODULE_13__.a.addToStore(store,events.emitAction),tocco_app_extensions_src_errorLogging__WEBPACK_IMPORTED_MODULE_12__.a.addToStore(store,!1),tocco_app_extensions_src_notifier__WEBPACK_IMPORTED_MODULE_11__.a.addToStore(store,!1),tocco_app_extensions_src_actions__WEBPACK_IMPORTED_MODULE_15__.a.addToStore(store,{formApp:tocco_simple_form_src_main__WEBPACK_IMPORTED_MODULE_18__.a,listApp:tocco_entity_list_src_main__WEBPACK_IMPORTED_MODULE_19__.a,customActions:_customActions__WEBPACK_IMPORTED_MODULE_23__.a}),tocco_app_extensions_src_formData__WEBPACK_IMPORTED_MODULE_16__.a.addToStore(store,{listApp:tocco_entity_list_src_main__WEBPACK_IMPORTED_MODULE_19__.a,linkFactory:input.linkFactory}),tocco_app_extensions_src_keyDown__WEBPACK_IMPORTED_MODULE_17__.a.addToStore(store,_shortcuts__WEBPACK_IMPORTED_MODULE_24__.a);var dispatchActions=Object(_input__WEBPACK_IMPORTED_MODULE_22__.a)(input),app=tocco_app_extensions_src_appFactory__WEBPACK_IMPORTED_MODULE_10__.a.createApp("entity-detail",_ref,store,{input:input,events:events,actions:dispatchActions,publicPath:publicPath,textResourceModules:["component","common","entity-list"]});return module.hot,app};tocco_app_extensions_src_appFactory__WEBPACK_IMPORTED_MODULE_10__.a.registerAppInRegistry("entity-detail",initApp);var EntityDetailApp=function(_React$Component){function EntityDetailApp(props){var _this;_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_1___default()(this,EntityDetailApp),_this=_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_3___default()(this,_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_4___default()(EntityDetailApp).call(this,props));var events=EXTERNAL_EVENTS.reduce(function(events,event){return props[event]&&(events[event]=props[event]),events},{});return _this.app=initApp("id",props,events),_this}return _babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_5___default()(EntityDetailApp,_React$Component),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_2___default()(EntityDetailApp,[{key:"render",value:function render(){return this.app.component}}]),EntityDetailApp}(react__WEBPACK_IMPORTED_MODULE_7___default.a.Component);EntityDetailApp.displayName="EntityDetailApp",__webpack_exports__.a=Object(react_hot_loader_root__WEBPACK_IMPORTED_MODULE_9__.hot)(EntityDetailApp),EntityDetailApp.__docgenInfo={description:"",methods:[],displayName:"EntityDetailApp",props:{entityName:{type:{name:"string"},required:!0,description:""},formName:{type:{name:"string"},required:!0,description:""},mode:{type:{name:"enum",value:[{value:"'update'",computed:!1},{value:"'create'",computed:!1}]},required:!1,description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/entity-detail/src/main.js"]={name:"EntityDetailApp",docgenInfo:EntityDetailApp.__docgenInfo,path:"packages/entity-detail/src/main.js"})}).call(this,__webpack_require__(73)(module))},2002:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__.a={CREATE:"create",UPDATE:"update"}},2009:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return AsyncValidationException}),__webpack_require__.d(__webpack_exports__,"c",function(){return submitValidate}),__webpack_require__.d(__webpack_exports__,"b",function(){return asyncValidate});__webpack_require__(20),__webpack_require__(29),__webpack_require__(30),__webpack_require__(21),__webpack_require__(64),__webpack_require__(79),__webpack_require__(208),__webpack_require__(28),__webpack_require__(8),__webpack_require__(26),__webpack_require__(33),__webpack_require__(19),__webpack_require__(35),__webpack_require__(22),__webpack_require__(67);var _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(3),_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_15___default=__webpack_require__.n(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_15__),_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(4),_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_16___default=__webpack_require__.n(_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_16__),_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_18__=(__webpack_require__(63),__webpack_require__(257)),_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_18___default=__webpack_require__.n(_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_18__),_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__(49),_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_19___default=__webpack_require__.n(_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_19__),redux_form_es_SubmissionError__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__(609),tocco_app_extensions_src_form__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__(98),tocco_app_extensions_src_rest__WEBPACK_IMPORTED_MODULE_22__=__webpack_require__(47),lodash_get__WEBPACK_IMPORTED_MODULE_23__=__webpack_require__(27),lodash_get__WEBPACK_IMPORTED_MODULE_23___default=__webpack_require__.n(lodash_get__WEBPACK_IMPORTED_MODULE_23__),tocco_util_src_api__WEBPACK_IMPORTED_MODULE_24__=__webpack_require__(164),_modes__WEBPACK_IMPORTED_MODULE_25__=__webpack_require__(2002);function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable})),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var source,i=1;i<arguments.length;i++)source=null==arguments[i]?{}:arguments[i],i%2?ownKeys(source,!0).forEach(function(key){_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_16___default()(target,key,source[key])}):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(source).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))});return target}var asyncValidators=tocco_app_extensions_src_form__WEBPACK_IMPORTED_MODULE_21__.a.validators.asyncValidators,AsyncValidationException=function AsyncValidationException(errors){_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_19___default()(this,AsyncValidationException),this.name="AsyncValidationException",this.errors=errors};AsyncValidationException.prototype=Object.create(Error.prototype);var hasError=function(errors){return errors&&0<Object.keys(errors).length},asyncValidateTypes=function(){var _ref=_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_18___default()(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_15___default.a.mark(function _callee(values,entityModel){var errors,key,value,type,typeValidator,fieldModel,validationError,error;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_15___default.a.wrap(function(_context){for(;;)switch(_context.prev=_context.next){case 0:errors={},_context.t0=_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_15___default.a.keys(values);case 2:if((_context.t1=_context.t0()).done){_context.next=16;break}if(key=_context.t1.value,!(value=values[key])){_context.next=14;break}if(type=lodash_get__WEBPACK_IMPORTED_MODULE_23___default()(entityModel,key+".type"),!(typeValidator=asyncValidators[type])){_context.next=14;break}return fieldModel=entityModel[key],_context.next=12,typeValidator(value,fieldModel);case 12:(validationError=_context.sent)&&(error=tocco_app_extensions_src_form__WEBPACK_IMPORTED_MODULE_21__.a.formErrorsUtil.addErrors(errors,key,validationError),errors=_objectSpread({},errors,{},error));case 14:_context.next=2;break;case 16:return _context.abrupt("return",errors);case 17:case"end":return _context.stop()}},_callee)}));return function(){return _ref.apply(this,arguments)}}(),validateRequest=function(formValues,initialValues,mode){var dirtyFields=tocco_app_extensions_src_form__WEBPACK_IMPORTED_MODULE_21__.a.getDirtyFields(initialValues,formValues),flattenEntity=tocco_app_extensions_src_form__WEBPACK_IMPORTED_MODULE_21__.a.formValuesToFlattenEntity(formValues),entity=tocco_util_src_api__WEBPACK_IMPORTED_MODULE_24__.a.toEntity(flattenEntity,dirtyFields),options={queryParams:{_validate:!0},method:mode===_modes__WEBPACK_IMPORTED_MODULE_25__.a.CREATE?"POST":"PATCH",body:entity};return tocco_app_extensions_src_rest__WEBPACK_IMPORTED_MODULE_22__.a.simpleRequest("entities/2.0/".concat(entity.model).concat(entity.key?"/".concat(entity.key):""),options).then(function(resp){return resp.body}).then(function(body){return body.valid?{}:tocco_app_extensions_src_form__WEBPACK_IMPORTED_MODULE_21__.a.validationErrorToFormError(entity,body.errors)})},submitValidate=function(formValues,initialValues,entityModel,mode){return validateRequest(formValues,initialValues,mode).then(function(errors){if(hasError(errors))throw new redux_form_es_SubmissionError__WEBPACK_IMPORTED_MODULE_20__.a(errors)})},asyncValidate=function(){var _ref2=_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_18___default()(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_15___default.a.mark(function _callee2(formValues,initialValues,entityModel,mode){var typeValidationErrors,validateRequestErrors;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_15___default.a.wrap(function(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.next=2,asyncValidateTypes(formValues,entityModel);case 2:if(typeValidationErrors=_context2.sent,!hasError(typeValidationErrors)){_context2.next=5;break}throw new AsyncValidationException(typeValidationErrors);case 5:return _context2.next=7,validateRequest(formValues,initialValues,mode);case 7:if(validateRequestErrors=_context2.sent,!hasError(validateRequestErrors)){_context2.next=10;break}throw new AsyncValidationException(validateRequestErrors);case 10:case"end":return _context2.stop()}},_callee2)}));return function(){return _ref2.apply(this,arguments)}}()},2032:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return getDispatchActions});var _modules_entityDetail_actions__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(2e3),getDispatchActions=function(input){return[Object(_modules_entityDetail_actions__WEBPACK_IMPORTED_MODULE_0__.A)(input.entityName),Object(_modules_entityDetail_actions__WEBPACK_IMPORTED_MODULE_0__.y)(input.entityId?input.entityId:null),Object(_modules_entityDetail_actions__WEBPACK_IMPORTED_MODULE_0__.F)(input.mode),Object(_modules_entityDetail_actions__WEBPACK_IMPORTED_MODULE_0__.D)(input.formName),Object(_modules_entityDetail_actions__WEBPACK_IMPORTED_MODULE_0__.v)(input.id),Object(_modules_entityDetail_actions__WEBPACK_IMPORTED_MODULE_0__.w)(input.defaultValues),Object(_modules_entityDetail_actions__WEBPACK_IMPORTED_MODULE_0__.t)()]}},2033:function(module,__webpack_exports__,__webpack_require__){"use strict";var _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(3),_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0__),redux_saga_effects__WEBPACK_IMPORTED_MODULE_2__=(__webpack_require__(63),__webpack_require__(1)),_modules_entityDetail_actions__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(2e3);__webpack_exports__.a={new:_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.mark(function _new(){return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.wrap(function(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,Object(redux_saga_effects__WEBPACK_IMPORTED_MODULE_2__.d)(Object(_modules_entityDetail_actions__WEBPACK_IMPORTED_MODULE_3__.u)());case 2:case"end":return _context.stop()}},_new)})}},2034:function(module,__webpack_exports__,__webpack_require__){"use strict";var _modules_entityDetail_actions__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(2e3);__webpack_exports__.a=[{ctrl:!0,key:"s",actions:[Object(_modules_entityDetail_actions__WEBPACK_IMPORTED_MODULE_0__.H)()]}]},2057:function(module,__webpack_exports__,__webpack_require__){"use strict";var es=__webpack_require__(37),index_es=__webpack_require__(16),es_getFormInitialValues=function createGetFormInitialValues(_ref){var getIn=_ref.getIn;return function(form,getFormState){return function(state){var nonNullGetFormState=getFormState||function(state){return getIn(state,"form")};return getIn(nonNullGetFormState(state),form+".initial")}}}(__webpack_require__(70).a),errorLogging=__webpack_require__(116),root=__webpack_require__(103),actions=__webpack_require__(2e3),classCallCheck=(__webpack_require__(29),__webpack_require__(49)),classCallCheck_default=__webpack_require__.n(classCallCheck),createClass=__webpack_require__(53),createClass_default=__webpack_require__.n(createClass),possibleConstructorReturn=__webpack_require__(50),possibleConstructorReturn_default=__webpack_require__.n(possibleConstructorReturn),getPrototypeOf=__webpack_require__(51),getPrototypeOf_default=__webpack_require__.n(getPrototypeOf),assertThisInitialized=__webpack_require__(54),assertThisInitialized_default=__webpack_require__.n(assertThisInitialized),inherits=__webpack_require__(52),inherits_default=__webpack_require__.n(inherits),defineProperty=__webpack_require__(4),defineProperty_default=__webpack_require__.n(defineProperty),react=(__webpack_require__(11),__webpack_require__(0)),react_default=__webpack_require__.n(react),isEmpty=__webpack_require__(249),isEmpty_default=__webpack_require__.n(isEmpty),src_form=__webpack_require__(98),src=__webpack_require__(6),get=(__webpack_require__(20),__webpack_require__(30),__webpack_require__(21),__webpack_require__(28),__webpack_require__(8),__webpack_require__(26),__webpack_require__(33),__webpack_require__(19),__webpack_require__(22),__webpack_require__(27)),get_default=__webpack_require__.n(get),getFormValues=__webpack_require__(275),getFormSyncErrors=__webpack_require__(978),getFormAsyncErrors=__webpack_require__(979),getFormSubmitErrors=__webpack_require__(977),reduxForm=__webpack_require__(306),src_formField=__webpack_require__(251),externalEvents=__webpack_require__(75),actionEmitter=__webpack_require__(134),main=__webpack_require__(607),SubGrid=function(props){var formBase="".concat(props.detailFormName,"_").concat(props.gridName);return react_default.a.createElement(main.a,{id:"".concat(props.appId,"-subgrid-").concat(formBase),entityName:props.modelField.targetEntity,formName:formBase,limit:props.limit,searchFormType:props.showSearchForm?"basic":"none",onRowClick:function onRowClick(e){props.onRowClick&&props.onRowClick({id:e.id,gridName:props.gridName,relationName:props.relationName})},onNavigateToCreate:function onNavigateToCreate(){props.navigateToCreate(props.relationName)},emitAction:function emitAction(action){props.dispatchEmittedAction(action)},parent:{key:props.entityKey,reverseRelationName:props.modelField.reverseRelationName,model:props.entityName}})};SubGrid.displayName="SubGrid",SubGrid.defaultProps={limit:5};var SubGrid_SubGrid=SubGrid;SubGrid.__docgenInfo={description:"",methods:[],displayName:"SubGrid",props:{limit:{defaultValue:{value:"5",computed:!1},type:{name:"number"},required:!1,description:""},entityKey:{type:{name:"union",value:[{name:"string"},{name:"number"}]},required:!1,description:""},entityName:{type:{name:"string"},required:!0,description:""},detailFormName:{type:{name:"string"},required:!0,description:""},gridName:{type:{name:"string"},required:!0,description:""},relationName:{type:{name:"string"},required:!0,description:""},modelField:{type:{name:"shape",value:{targetEntity:{name:"string",required:!1},reverseRelationName:{name:"string",required:!1}}},required:!0,description:""},onRowClick:{type:{name:"func"},required:!1,description:""},navigateToCreate:{type:{name:"func"},required:!0,description:""},dispatchEmittedAction:{type:{name:"func"},required:!0,description:""},showSubGridsCreateButton:{type:{name:"bool"},required:!1,description:""},appId:{type:{name:"string"},required:!1,description:""},showSearchForm:{type:{name:"bool"},required:!1,description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/entity-detail/src/components/SubGrid/SubGrid.js"]={name:"SubGrid",docgenInfo:SubGrid.__docgenInfo,path:"packages/entity-detail/src/components/SubGrid/SubGrid.js"});var components_SubGrid=SubGrid_SubGrid,mapActionCreators={onRowClick:function onRowClick(e){return externalEvents.a.fireExternalEvent("onSubGridRowClick",{id:e.id,gridName:e.gridName,relationName:e.relationName})},navigateToCreate:actions.u,onNavigateToCreate:function onNavigateToCreate(relationName){return externalEvents.a.fireExternalEvent("onNavigateToCreate",relationName)},dispatchEmittedAction:actionEmitter.a.dispatchEmittedAction},SubGridContainer=Object(es.connect)(function(state){return{appId:state.entityDetail.appId,entityKey:state.entityDetail.entity.key,entityName:state.entityDetail.entity.model,detailFormName:state.entityDetail.formDefinition.id,showSubGridsCreateButton:state.entityDetail.showSubGridCreateButton}},mapActionCreators)(components_SubGrid),subGrid=function(formField,modelField,key){return react_default.a.createElement(SubGridContainer,{key:key,gridName:formField.id,relationName:formField.id,modelField:modelField,showSearchForm:formField.showSearchForm,limit:formField.limit||void 0})},_ref2=(__webpack_require__(31),react_default.a.createElement(index_es.FormattedMessage,{id:"client.entity-detail.invalidFieldsError"})),_ref3=react_default.a.createElement(index_es.FormattedMessage,{id:"client.entity-detail.validatorErrors"}),_ref4=react_default.a.createElement(index_es.FormattedMessage,{id:"client.entity-detail.invalidRelationErrors"}),components_ErrorBox=function(_ref){var formErrors=_ref.formErrors,showErrors=_ref.showErrors,output=null,elements=[];return src_form.a.formErrorsUtil.hasFieldErrors(formErrors)&&elements.push(react_default.a.createElement(src.p.Item,{condition:src.B.condition.DANGER,key:"hasFieldErrors"},react_default.a.createElement(src.j,{label:_ref2,neutral:!0,onClick:showErrors}))),src_form.a.formErrorsUtil.hasValidatorErrors(formErrors)&&elements.push(react_default.a.createElement(src.p.Item,{condition:src.B.condition.DANGER,key:"hasValidatorErrors"},_ref3,react_default.a.createElement(src.p.List,null,src_form.a.formErrorsUtil.getValidatorErrors(formErrors).map(function(message,idx){return react_default.a.createElement(src.p.Item,{condition:src.B.condition.DANGER,key:idx,label:message})})))),src_form.a.formErrorsUtil.hasRelatedEntityErrors(formErrors)&&elements.push(react_default.a.createElement(src.p.Item,{condition:src.B.condition.DANGER,key:"hasRelatedEntityErrors"},_ref4,react_default.a.createElement(src.p.List,null,src_form.a.formErrorsUtil.getRelatedEntityErrorsCompact(formErrors).map(function(message,idx){return react_default.a.createElement(src.p.Item,{condition:src.B.condition.DANGER,key:idx,label:message})})))),0<elements.length&&(output=react_default.a.createElement(src.o,{condition:src.B.condition.DANGER},react_default.a.createElement(src.p.List,null,elements.map(function(el){return el})))),output},readOnlyFormFieldMapping={binary:src_formField.a.formattedValueFactory("document"),birthdate:src_formField.a.formattedValueFactory("birthdate"),boolean:src_formField.a.formattedValueFactory("boolean"),code:src_formField.a.formattedValueFactory("text"),counter:src_formField.a.formattedValueFactory("string"),"data-amount":src_formField.a.formattedValueFactory("number"),date:src_formField.a.formattedValueFactory("date"),datetime:src_formField.a.formattedValueFactory("datetime"),time:src_formField.a.formattedValueFactory("time"),decimal:src_formField.a.formattedValueFactory("decimal"),display:src_formField.a.formattedValueFactory("html"),duration:src_formField.a.formattedValueFactory("duration"),document:src_formField.a.formattedValueFactory("document"),email:src_formField.a.formattedValueFactory("email"),html:src_formField.a.formattedValueFactory("html"),image:src_formField.a.formattedValueFactory("document"),identifier:src_formField.a.formattedValueFactory("string"),latitude:src_formField.a.formattedValueFactory("latitude"),login:src_formField.a.formattedValueFactory("string"),long:src_formField.a.formattedValueFactory("string"),longitude:src_formField.a.formattedValueFactory("longitude"),moneyamount:src_formField.a.formattedValueFactory("moneyamount"),"multi-remote-field":src_formField.a.formattedValueFactory("multi-remote"),"multi-select-box":src_formField.a.formattedValueFactory("multi-select"),"named-upload":src_formField.a.formattedValueFactory("document"),integer:src_formField.a.formattedValueFactory("number"),percent:src_formField.a.formattedValueFactory("number"),phone:src_formField.a.formattedValueFactory("phone"),"pulldown-date":src_formField.a.formattedValueFactory("date"),range:{date:src_formField.a.formattedValueFactory("date-range"),birthdate:src_formField.a.formattedValueFactory("date-range")},remote:src_formField.a.formattedValueFactory("remote"),"search-filter":src_formField.a.formattedValueFactory("search-filter"),"single-remote-field":src_formField.a.formattedValueFactory("remote"),"single-select-box":src_formField.a.formattedValueFactory("single-select"),sorting:src_formField.a.formattedValueFactory("number"),string:src_formField.a.formattedValueFactory("string"),text:src_formField.a.formattedValueFactory("text"),"text-area":src_formField.a.formattedValueFactory("text"),upload:src_formField.a.formattedValueFactory("document"),url:src_formField.a.formattedValueFactory("url"),uuid:src_formField.a.formattedValueFactory("string"),subTable:subGrid},modes=__webpack_require__(2002),SaveButton=function(_ref){var submitting=_ref.submitting,mode=_ref.mode,intl=_ref.intl;return react_default.a.createElement(src.b,{"data-cy":"detail-form_submit-button",disabled:submitting,ink:"primary",label:function msg(id){return intl.formatMessage({id:id})}("client.entity-detail.".concat(mode===modes.a.CREATE?"create":"save")),look:"raised",pending:submitting,type:"submit"})};SaveButton.displayName="SaveButton";var DetailForm_SaveButton=SaveButton;SaveButton.__docgenInfo={description:"",methods:[],displayName:"SaveButton",props:{intl:{type:{name:"custom",raw:"intlShape.isRequired"},required:!1,description:""},submitting:{type:{name:"bool"},required:!1,description:""},mode:{type:{name:"enum",computed:!0,value:"Object.values(modes)"},required:!1,description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/entity-detail/src/components/DetailForm/SaveButton.js"]={name:"SaveButton",docgenInfo:SaveButton.__docgenInfo,path:"packages/entity-detail/src/components/DetailForm/SaveButton.js"});var DetailForm=function(props){Object(react.useEffect)(function(){props.fireTouched(props.dirty)},[props.dirty]);var customActions=Object(react.useMemo)(function(){return{save:function(){return react_default.a.createElement(DetailForm_SaveButton,{intl:props.intl,submitting:props.submitting,mode:props.mode})}}},[props.submitting,props.mode]),showErrors=function(event){var firstErrorField;event&&event.preventDefault(),props.touchAllFields(),(firstErrorField=src_form.a.formErrorsUtil.getFirstErrorField(props.formErrors))&&document.getElementById(src_form.a.getFieldId(props.form,firstErrorField))&&document.getElementById(src_form.a.getFieldId(props.form,firstErrorField)).focus()};return react_default.a.createElement("form",{onSubmit:function handleSubmit(event){event.preventDefault(),props.valid?props.submitForm():props.formErrors&&showErrors()},onKeyDown:function handleKeyPress(event){"Enter"===event.key&&"TEXTAREA"!==event.target.tagName&&event.preventDefault()}},react_default.a.createElement(src_form.a.FormBuilder,{entity:props.entity,model:props.entityModel,formName:props.form,formDefinition:props.formDefinition,formValues:props.formValues,formFieldMapping:src_formField.a.defaultMapping,readOnlyFormFieldMapping:readOnlyFormFieldMapping,mode:props.mode,componentMapping:defineProperty_default()({},src_form.a.componentTypes.SUB_TABLE,subGrid),customActions:customActions}),!props.valid&&props.anyTouched&&react_default.a.createElement(components_ErrorBox,{formErrors:props.formErrors,showErrors:showErrors}))};DetailForm.displayName="DetailForm";var DetailForm_DetailForm=Object(reduxForm.a)({form:"detailForm",destroyOnUnmount:!1})(DetailForm);function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable})),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var source,i=1;i<arguments.length;i++)source=null==arguments[i]?{}:arguments[i],i%2?ownKeys(source,!0).forEach(function(key){defineProperty_default()(target,key,source[key])}):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(source).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))});return target}DetailForm.__docgenInfo={description:"",methods:[],displayName:"DetailForm",props:{intl:{type:{name:"custom",raw:"intlShape.isRequired"},required:!1,description:""},mode:{type:{name:"enum",value:[{value:"'update'",computed:!1},{value:"'create'",computed:!1}]},required:!1,description:""},entityModel:{type:{name:"object"},required:!0,description:""},submitForm:{type:{name:"func"},required:!0,description:""},formDefinition:{type:{name:"object"},required:!0,description:""},entity:{type:{name:"object"},required:!0,description:""},form:{type:{name:"string"},required:!0,description:""},touch:{type:{name:"func"},required:!0,description:""},formValues:{type:{name:"object"},required:!1,description:""},submitting:{type:{name:"bool"},required:!1,description:""},formErrors:{type:{name:"object"},required:!1,description:""},valid:{type:{name:"bool"},required:!1,description:""},dirty:{type:{name:"bool"},required:!1,description:""},lastSave:{type:{name:"number"},required:!1,description:""},fireTouched:{type:{name:"func"},required:!0,description:""},touchAllFields:{type:{name:"func"},required:!0,description:""},anyTouched:{type:{name:"bool"},required:!1,description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/entity-detail/src/components/DetailForm/DetailForm.js"]={name:"DetailForm",docgenInfo:DetailForm.__docgenInfo,path:"packages/entity-detail/src/components/DetailForm/DetailForm.js"});var DetailFormContainer_mapActionCreators={unloadDetailView:actions.J,submitForm:actions.H,fireTouched:actions.s,touchAllFields:actions.I,logError:errorLogging.a.logError},DetailFormContainer=Object(es.connect)(function(state){return{formDefinition:state.entityDetail.formDefinition,entity:state.entityDetail.entity,entityModel:state.entityDetail.entityModel,formValues:Object(getFormValues.a)("detailForm")(state),formErrors:_objectSpread({},Object(getFormSyncErrors.a)("detailForm")(state),{},Object(getFormAsyncErrors.a)("detailForm")(state),{},Object(getFormSubmitErrors.a)("detailForm")(state),{_error:(formName="detailForm",function(state){return get_default()(state,"form.".concat(formName,".error"),{})})(state)}),formInitialValues:es_getFormInitialValues("detailForm")(state),lastSave:state.entityDetail.lastSave};var formName},DetailFormContainer_mapActionCreators)(Object(index_es.injectIntl)(DetailForm_DetailForm)),asyncValidation=__webpack_require__(2009),DetailView_DetailView=function(_React$Component){function DetailView(){var _getPrototypeOf2,_this;classCallCheck_default()(this,DetailView);for(var _len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return _this=possibleConstructorReturn_default()(this,(_getPrototypeOf2=getPrototypeOf_default()(DetailView)).call.apply(_getPrototypeOf2,[this].concat(args))),defineProperty_default()(assertThisInitialized_default()(_this),"handledAsyncValidate",function(formValues){return Object(asyncValidation.b)(formValues,_this.props.formInitialValues,_this.props.entityModel,_this.props.mode).catch(function(error){if(error instanceof asyncValidation.a)throw error.errors;_this.props.logError("client.common.unexpectedError","client.entity-detail.validationError",error)})}),defineProperty_default()(assertThisInitialized_default()(_this),"getSyncValidation",function(){return _this.validateSingleton||isEmpty_default()(_this.props.entityModel)||(_this.validateSingleton=src_form.a.syncValidation(_this.props.entityModel)),_this.validateSingleton}),defineProperty_default()(assertThisInitialized_default()(_this),"msg",function(id){return _this.props.intl.formatMessage({id:id})}),_this}return inherits_default()(DetailView,_React$Component),createClass_default()(DetailView,[{key:"componentWillUnmount",value:function componentWillUnmount(){this.props.unloadDetailView()}},{key:"render",value:function render(){var props=this.props;return react_default.a.createElement(src.k,{required:[props.formInitialValues],loadingText:this.msg("client.entity-detail.loadingText")},react_default.a.createElement(DetailFormContainer,{mode:this.props.mode,validate:this.getSyncValidation(),asyncValidate:this.handledAsyncValidate}))}}]),DetailView}(react_default.a.Component);DetailView_DetailView.displayName="DetailView";var components_DetailView_DetailView=DetailView_DetailView;DetailView_DetailView.__docgenInfo={description:"",methods:[{name:"handledAsyncValidate",docblock:null,modifiers:[],params:[{name:"formValues",type:null}],returns:null},{name:"getSyncValidation",docblock:null,modifiers:[],params:[],returns:null},{name:"msg",docblock:null,modifiers:[],params:[{name:"id",type:null}],returns:null}],displayName:"DetailView",props:{intl:{type:{name:"custom",raw:"intlShape.isRequired"},required:!1,description:""},mode:{type:{name:"enum",value:[{value:"'update'",computed:!1},{value:"'create'",computed:!1}]},required:!1,description:""},loadDetailView:{type:{name:"func"},required:!0,description:""},unloadDetailView:{type:{name:"func"},required:!0,description:""},logError:{type:{name:"func"},required:!0,description:""},entityModel:{type:{name:"object"},required:!0,description:""},entityName:{type:{name:"string"},required:!0,description:""},entityId:{type:{name:"string"},required:!1,description:""},formInitialValues:{type:{name:"shape",value:{initial:{name:"objectOf",value:{name:"string"},required:!1}}},required:!1,description:""}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["packages/entity-detail/src/components/DetailView/DetailView.js"]={name:"DetailView",docgenInfo:DetailView_DetailView.__docgenInfo,path:"packages/entity-detail/src/components/DetailView/DetailView.js"});var DetailViewContainer_mapActionCreators={loadDetailView:actions.t,unloadDetailView:actions.J,logError:errorLogging.a.logError};__webpack_exports__.a=Object(root.hot)(Object(es.connect)(function(state){return{entityName:state.entityDetail.entityName,entityId:state.entityDetail.entityId,entityModel:state.entityDetail.entityModel,mode:state.entityDetail.mode,formInitialValues:es_getFormInitialValues("detailForm")(state)}},DetailViewContainer_mapActionCreators)(Object(index_es.injectIntl)(components_DetailView_DetailView)))},2059:function(module,__webpack_exports__,__webpack_require__){"use strict";var _ACTION_HANDLERS,reducer=__webpack_require__(438),defineProperty=__webpack_require__(4),defineProperty_default=__webpack_require__.n(defineProperty),src_reducer=__webpack_require__(34),actions=__webpack_require__(2e3),ACTION_HANDLERS=(_ACTION_HANDLERS={},defineProperty_default()(_ACTION_HANDLERS,actions.i,src_reducer.a.singleTransferReducer("entityName")),defineProperty_default()(_ACTION_HANDLERS,actions.l,src_reducer.a.singleTransferReducer("formName")),defineProperty_default()(_ACTION_HANDLERS,actions.g,src_reducer.a.singleTransferReducer("entityId")),defineProperty_default()(_ACTION_HANDLERS,actions.n,src_reducer.a.singleTransferReducer("mode")),defineProperty_default()(_ACTION_HANDLERS,actions.k,src_reducer.a.singleTransferReducer("formDefinition")),defineProperty_default()(_ACTION_HANDLERS,actions.f,src_reducer.a.singleTransferReducer("entity")),defineProperty_default()(_ACTION_HANDLERS,actions.m,src_reducer.a.singleTransferReducer("lastSave")),defineProperty_default()(_ACTION_HANDLERS,actions.h,src_reducer.a.singleTransferReducer("entityModel")),defineProperty_default()(_ACTION_HANDLERS,actions.o,src_reducer.a.singleTransferReducer("touched")),defineProperty_default()(_ACTION_HANDLERS,actions.d,src_reducer.a.singleTransferReducer("appId")),defineProperty_default()(_ACTION_HANDLERS,actions.e,src_reducer.a.singleTransferReducer("defaultValues")),defineProperty_default()(_ACTION_HANDLERS,actions.j,src_reducer.a.singleTransferReducer("fieldDefinitions")),_ACTION_HANDLERS),initialState={appId:"",entityName:"",formName:"",mode:"update",formDefinition:{},entity:{},entityModel:{},touched:!1,defaultValues:{},fieldDefinitions:[]};__webpack_require__(20),__webpack_require__(29),__webpack_require__(30),__webpack_require__(21),__webpack_require__(107),__webpack_require__(77),__webpack_require__(31),__webpack_require__(28),__webpack_require__(8),__webpack_require__(26),__webpack_require__(33),__webpack_require__(19),__webpack_require__(110),__webpack_require__(22);var toConsumableArray=__webpack_require__(55),toConsumableArray_default=__webpack_require__.n(toConsumableArray),regenerator=__webpack_require__(3),regenerator_default=__webpack_require__.n(regenerator),es_actions=(__webpack_require__(63),__webpack_require__(96)),SubmissionError=__webpack_require__(609),getFormValues=__webpack_require__(275),externalEvents=__webpack_require__(75),notifier=__webpack_require__(57),errorLogging=__webpack_require__(116),src_form=__webpack_require__(98),src_actions=__webpack_require__(138),actionEmitter=__webpack_require__(134),rest=__webpack_require__(47),api=__webpack_require__(164),effects=__webpack_require__(1),_marked=(__webpack_require__(136),__webpack_require__(69),__webpack_require__(127),regenerator_default.a.mark(updateEntity)),_marked2=regenerator_default.a.mark(createEntity);function updateEntity(entity){var paths,options,resource,resp,_args=arguments;return regenerator_default.a.wrap(function(_context){for(;;)switch(_context.prev=_context.next){case 0:return paths=1<_args.length&&void 0!==_args[1]?_args[1]:[],options={method:"PATCH",queryParams:{_paths:paths.join(",")},body:entity,acceptedErrorCodes:["VALIDATION_FAILED"]},resource="entities/2.0/".concat(entity.model,"/").concat(entity.key),_context.next=5,Object(effects.b)(rest.a.requestSaga,resource,options);case 5:if("VALIDATION_FAILED"!==(resp=_context.sent).body.errorCode){_context.next=8;break}throw new SubmissionError.a(src_form.a.validationErrorToFormError(entity,resp.body.errors));case 8:return _context.abrupt("return",resp.body);case 9:case"end":return _context.stop()}},_marked)}var SUCCESSFUL_SAVED_STATUS=201;function createEntity(entity){var paths,options,resource,resp,location,id,_args2=arguments;return regenerator_default.a.wrap(function(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return paths=1<_args2.length&&void 0!==_args2[1]?_args2[1]:[],options={method:"POST",queryParams:{_paths:paths.join(",")},body:entity,acceptedErrorCodes:["VALIDATION_FAILED"]},resource="entities/2.0/".concat(entity.model),_context2.next=5,Object(effects.b)(rest.a.requestSaga,resource,options);case 5:if((resp=_context2.sent).status!==SUCCESSFUL_SAVED_STATUS){_context2.next=12;break}return location=resp.headers.get("Location"),id=location.split("/").pop(),_context2.abrupt("return",id);case 12:if(!resp.body||"VALIDATION_FAILED"!==resp.body.errorCode){_context2.next=14;break}throw new SubmissionError.a(src_form.a.validationErrorToFormError(entity,resp.body.errors));case 14:throw new Error("unexpected error during save",resp);case 15:case"end":return _context2.stop()}},_marked2)}var asyncValidation=__webpack_require__(2009),modes=__webpack_require__(2002);function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable})),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var source,i=1;i<arguments.length;i++)source=null==arguments[i]?{}:arguments[i],i%2?ownKeys(source,!0).forEach(function(key){defineProperty_default()(target,key,source[key])}):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(source).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))});return target}var sagas_marked=regenerator_default.a.mark(sagas),sagas_marked2=regenerator_default.a.mark(loadDetailFormDefinition),_marked3=regenerator_default.a.mark(loadEntity),_marked4=regenerator_default.a.mark(unloadDetailView),_marked5=regenerator_default.a.mark(loadEntityModel),_marked6=regenerator_default.a.mark(loadDetailView),_marked7=regenerator_default.a.mark(updateFormSubmit),_marked8=regenerator_default.a.mark(createFormSubmit),_marked9=regenerator_default.a.mark(touchAllFields),_marked10=regenerator_default.a.mark(handleSubmitError),_marked11=regenerator_default.a.mark(getEntityForSubmit),_marked13=regenerator_default.a.mark(submitForm),_marked14=regenerator_default.a.mark(fireTouched),_marked15=regenerator_default.a.mark(showNotification),_marked16=regenerator_default.a.mark(loadDisplayExpressions),_marked17=regenerator_default.a.mark(loadRelationDisplays),_marked18=regenerator_default.a.mark(enhanceEntityWithDisplayExpressions),_marked19=regenerator_default.a.mark(enhanceEntityWithDisplays),_marked20=regenerator_default.a.mark(loadData),_marked21=regenerator_default.a.mark(actionInvoked),_marked22=regenerator_default.a.mark(navigateToCreate),formInitialValueSelector=function(state,formId){return state.form[formId].initial},entityDetailSelector=function(state){return state.entityDetail},FORM_ID="detailForm";function sagas(){return regenerator_default.a.wrap(function(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,Object(effects.a)([Object(effects.c)(effects.i,actions.b,loadDetailView),Object(effects.c)(effects.i,actions.r,unloadDetailView),Object(effects.c)(effects.i,actions.q,touchAllFields),Object(effects.c)(effects.h,actions.p,submitForm),Object(effects.c)(effects.h,actions.a,fireTouched),Object(effects.c)(effects.h,actions.c,navigateToCreate),Object(effects.c)(effects.h,src_actions.a.actions.ACTION_INVOKED,actionInvoked)]);case 2:case"end":return _context.stop()}},sagas_marked)}function loadDetailFormDefinition(formName,mode){var formDefinition,fieldDefinitions;return regenerator_default.a.wrap(function(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.next=2,Object(effects.b)(rest.a.fetchForm,formName,mode);case 2:return formDefinition=_context2.sent,_context2.next=5,Object(effects.d)(actions.C(formDefinition));case 5:return _context2.next=7,Object(effects.b)(src_form.a.getFieldDefinitions,formDefinition);case 7:return fieldDefinitions=_context2.sent,_context2.next=10,Object(effects.d)(actions.B(fieldDefinitions));case 10:return _context2.abrupt("return",{formDefinition:formDefinition,fieldDefinitions:fieldDefinitions});case 11:case"end":return _context2.stop()}},sagas_marked2)}function loadEntity(entityName,entityId,fieldDefinitions){var paths,entity;return regenerator_default.a.wrap(function(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:return _context3.next=2,Object(effects.b)(src_form.a.getUsedPaths,fieldDefinitions);case 2:return paths=_context3.sent,_context3.next=5,Object(effects.b)(rest.a.fetchEntity,entityName,entityId,{paths:paths});case 5:return entity=_context3.sent,_context3.next=8,Object(effects.d)(actions.x(entity));case 8:return _context3.abrupt("return",entity);case 9:case"end":return _context3.stop()}},_marked3)}function unloadDetailView(){return regenerator_default.a.wrap(function(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:return _context4.next=2,Object(effects.d)(actions.x(null));case 2:return _context4.next=4,Object(effects.d)(es_actions.a.destroy(FORM_ID));case 4:case"end":return _context4.stop()}},_marked4)}function loadEntityModel(entityName){var entityModel;return regenerator_default.a.wrap(function(_context5){for(;;)switch(_context5.prev=_context5.next){case 0:return _context5.next=2,Object(effects.b)(rest.a.fetchModel,entityName);case 2:return entityModel=_context5.sent,_context5.next=5,Object(effects.d)(actions.z(entityModel));case 5:return _context5.abrupt("return",entityModel);case 6:case"end":return _context5.stop()}},_marked5)}function loadDetailView(){var _ref,entityName,formName,mode,defaultValues,model,_ref2,fieldDefinitions,formDefaultValues,inputDefaultValues,defaultValuesFields,flattenEntity,formValues;return regenerator_default.a.wrap(function(_context6){for(;;)switch(_context6.prev=_context6.next){case 0:return _context6.next=2,Object(effects.e)(entityDetailSelector);case 2:return _ref=_context6.sent,entityName=_ref.entityName,formName=_ref.formName,mode=_ref.mode,defaultValues=_ref.defaultValues,_context6.next=9,Object(effects.b)(loadEntityModel,entityName);case 9:return model=_context6.sent,_context6.next=12,Object(effects.b)(loadDetailFormDefinition,formName,mode);case 12:if(_ref2=_context6.sent,fieldDefinitions=_ref2.fieldDefinitions,mode!==modes.a.CREATE){_context6.next=39;break}return _context6.next=17,Object(effects.d)(actions.x({paths:{},model:entityName}));case 17:return _context6.next=19,Object(effects.b)(src_form.a.getDefaultValues,fieldDefinitions);case 19:if(formDefaultValues=_context6.sent,!defaultValues){_context6.next=26;break}return _context6.next=23,Object(effects.b)(src_form.a.transformInputValues,defaultValues,model);case 23:_context6.t0=_context6.sent,_context6.next=27;break;case 26:_context6.t0={};case 27:return inputDefaultValues=_context6.t0,defaultValuesFields=_objectSpread({},formDefaultValues,{},inputDefaultValues),_context6.next=31,Object(effects.b)(api.a.getFlattenEntity,{model:entityName});case 31:return flattenEntity=_context6.sent,_context6.next=34,Object(effects.b)(src_form.a.entityToFormValues,_objectSpread({},flattenEntity,{},defaultValuesFields));case 34:return formValues=_context6.sent,_context6.next=37,Object(effects.d)(es_actions.a.initialize(FORM_ID,formValues));case 37:_context6.next=41;break;case 39:return _context6.next=41,Object(effects.b)(loadData);case 41:case"end":return _context6.stop()}},_marked6)}function updateFormSubmit(entity){return regenerator_default.a.wrap(function(_context7){for(;;)switch(_context7.prev=_context7.next){case 0:return _context7.next=2,Object(effects.b)(updateEntity,entity);case 2:return _context7.next=4,Object(effects.b)(loadData);case 4:return _context7.next=6,Object(effects.b)(showNotification,"success","saveSuccessfulTitle","saveSuccessfulMessage");case 6:return _context7.next=8,Object(effects.d)(actions.E());case 8:return _context7.next=10,Object(effects.d)(es_actions.a.stopSubmit(FORM_ID));case 10:case"end":return _context7.stop()}},_marked7)}function createFormSubmit(entity){var createdEntityId;return regenerator_default.a.wrap(function(_context8){for(;;)switch(_context8.prev=_context8.next){case 0:return _context8.next=2,Object(effects.b)(createEntity,entity);case 2:return createdEntityId=_context8.sent,_context8.next=5,Object(effects.d)(externalEvents.a.fireExternalEvent("onEntityCreated",{id:createdEntityId}));case 5:return _context8.next=7,Object(effects.b)(showNotification,"success","createSuccessfulTitle","createSuccessfulMessage");case 7:case"end":return _context8.stop()}},_marked8)}function touchAllFields(){var _ref3,fieldDefinitions;return regenerator_default.a.wrap(function(_context9){for(;;)switch(_context9.prev=_context9.next){case 0:return _context9.next=2,Object(effects.e)(entityDetailSelector);case 2:return _ref3=_context9.sent,fieldDefinitions=_ref3.fieldDefinitions,_context9.next=6,Object(effects.d)(es_actions.a.touch.apply(es_actions.a,[FORM_ID].concat(toConsumableArray_default()(fieldDefinitions.map(function(f){return src_form.a.transformFieldName(f.path)})))));case 6:case"end":return _context9.stop()}},_marked9)}function handleSubmitError(error){return regenerator_default.a.wrap(function(_context10){for(;;)switch(_context10.prev=_context10.next){case 0:if(!(error instanceof SubmissionError.a)){_context10.next=7;break}return _context10.next=3,Object(effects.b)(touchAllFields);case 3:return _context10.next=5,Object(effects.d)(es_actions.a.stopSubmit(FORM_ID,error.errors));case 5:_context10.next=12;break;case 7:if(error instanceof rest.a.ClientQuestionCancelledException){_context10.next=10;break}return _context10.next=10,Object(effects.d)(errorLogging.a.logError("client.common.unexpectedError","client.entity-detail.saveError",error));case 10:return _context10.next=12,Object(effects.d)(es_actions.a.stopSubmit(FORM_ID));case 12:return _context10.next=14,Object(effects.b)(showNotification,"warning","saveAbortedTitle","saveAbortedMessage",5e3);case 14:case"end":return _context10.stop()}},_marked10)}function getEntityForSubmit(){var formValues,initialFormValues,_ref4,entityModel,mode,initialValues,dirtyFields,flattenEntity;return regenerator_default.a.wrap(function(_context11){for(;;)switch(_context11.prev=_context11.next){case 0:return _context11.next=2,Object(effects.e)(Object(getFormValues.a)(FORM_ID));case 2:return formValues=_context11.sent,_context11.next=5,Object(effects.e)(formInitialValueSelector,FORM_ID);case 5:return initialFormValues=_context11.sent,_context11.next=8,Object(effects.e)(entityDetailSelector);case 8:return _ref4=_context11.sent,entityModel=_ref4.entityModel,mode=_ref4.mode,initialValues=mode===modes.a.CREATE?{}:initialFormValues,_context11.next=14,Object(effects.d)(es_actions.a.startSubmit(FORM_ID));case 14:return _context11.next=16,Object(effects.b)(asyncValidation.c,formValues,initialValues,entityModel,mode);case 16:return _context11.next=18,Object(effects.b)(src_form.a.getDirtyFields,initialValues,formValues,mode===modes.a.CREATE);case 18:return dirtyFields=_context11.sent,_context11.next=21,Object(effects.b)(src_form.a.formValuesToFlattenEntity,formValues);case 21:return flattenEntity=_context11.sent,_context11.next=24,Object(effects.b)(api.a.toEntity,flattenEntity,dirtyFields);case 24:return _context11.abrupt("return",_context11.sent);case 25:case"end":return _context11.stop()}},_marked11)}function submitForm(){var _ref6,mode,entity;return regenerator_default.a.wrap(function(_context13){for(;;)switch(_context13.prev=_context13.next){case 0:return _context13.prev=0,_context13.next=3,Object(effects.e)(entityDetailSelector);case 3:return _ref6=_context13.sent,mode=_ref6.mode,_context13.next=7,Object(effects.b)(getEntityForSubmit);case 7:if(entity=_context13.sent,mode!==modes.a.UPDATE){_context13.next=13;break}return _context13.next=11,Object(effects.b)(updateFormSubmit,entity);case 11:_context13.next=16;break;case 13:if(mode!==modes.a.CREATE){_context13.next=16;break}return _context13.next=16,Object(effects.b)(createFormSubmit,entity);case 16:_context13.next=22;break;case 18:return _context13.prev=18,_context13.t0=_context13.catch(0),_context13.next=22,Object(effects.b)(handleSubmitError,_context13.t0);case 22:case"end":return _context13.stop()}},_marked13,null,[[0,18]])}function fireTouched(_ref7){var payload,actionTouched,_ref8,stateTouched;return regenerator_default.a.wrap(function(_context14){for(;;)switch(_context14.prev=_context14.next){case 0:return payload=_ref7.payload,actionTouched=payload.touched,_context14.next=4,Object(effects.e)(entityDetailSelector);case 4:if(_ref8=_context14.sent,stateTouched=_ref8.touched,actionTouched===stateTouched){_context14.next=11;break}return _context14.next=9,Object(effects.d)(externalEvents.a.fireExternalEvent("onTouchedChange",{touched:actionTouched}));case 9:return _context14.next=11,Object(effects.d)(actions.G(actionTouched));case 11:case"end":return _context14.stop()}},_marked14)}function showNotification(type,titleResourceName,messageResourceName){var duration,_args15=arguments;return regenerator_default.a.wrap(function(_context15){for(;;)switch(_context15.prev=_context15.next){case 0:return duration=3<_args15.length&&void 0!==_args15[3]?_args15[3]:2e3,_context15.next=3,Object(effects.d)(notifier.a.info(type,"client.entity-detail.".concat(titleResourceName),"client.entity-detail.".concat(messageResourceName),"check",duration));case 3:case"end":return _context15.stop()}},_marked15)}function loadDisplayExpressions(formName,mode,paths,entities){var keys,result;return regenerator_default.a.wrap(function(_context16){for(;;)switch(_context16.prev=_context16.next){case 0:if(!(paths&&0<paths.length)){_context16.next=6;break}return keys=entities.map(function(e){return e.__key}),_context16.next=4,Object(effects.b)(rest.a.fetchDisplayExpressions,formName,mode,keys,paths);case 4:return result=_context16.sent,_context16.abrupt("return",result);case 6:case"end":return _context16.stop()}},_marked16)}function loadRelationDisplays(relationFields,entities){var request;return regenerator_default.a.wrap(function(_context17){for(;;)switch(_context17.prev=_context17.next){case 0:if(!(relationFields&&0<relationFields.length)){_context17.next=7;break}return _context17.next=3,Object(effects.b)(api.a.getPathDisplayRequest,entities,relationFields,{});case 3:return request=_context17.sent,_context17.next=6,Object(effects.b)(rest.a.fetchDisplays,request);case 6:return _context17.abrupt("return",_context17.sent);case 7:case"end":return _context17.stop()}},_marked17)}function enhanceEntityWithDisplayExpressions(entity){var _ref9,fieldDefinitions,formName,mode,displayExpressions,displayExpressionsL;return regenerator_default.a.wrap(function(_context18){for(;;)switch(_context18.prev=_context18.next){case 0:return _context18.next=2,Object(effects.e)(entityDetailSelector);case 2:return _ref9=_context18.sent,fieldDefinitions=_ref9.fieldDefinitions,formName=_ref9.formName,mode=_ref9.mode,displayExpressions=fieldDefinitions.filter(function(f){return"display"===f.componentType}).map(function(f){return f.id}),_context18.next=9,Object(effects.b)(loadDisplayExpressions,formName,mode,displayExpressions,[entity]);case 9:(displayExpressionsL=_context18.sent)&&Object.keys(displayExpressionsL[entity.__key]).forEach(function(dE){entity[dE]=displayExpressionsL[entity.__key][dE]});case 11:case"end":return _context18.stop()}},_marked18)}function enhanceEntityWithDisplays(entity){var _ref10,fieldDefinitions,relationFields,displays;return regenerator_default.a.wrap(function(_context19){for(;;)switch(_context19.prev=_context19.next){case 0:return _context19.next=2,Object(effects.e)(entityDetailSelector);case 2:return _ref10=_context19.sent,fieldDefinitions=_ref10.fieldDefinitions,relationFields=fieldDefinitions.filter(function(f){return api.a.relationFieldTypes.includes(f.dataType)}).map(function(f){return f.path}),_context19.next=7,Object(effects.b)(loadRelationDisplays,relationFields,[entity]);case 7:displays=_context19.sent,relationFields.forEach(function(relationField){var value=entity[relationField];if(value){var newValue=Array.isArray(value)?value.map(function(v2){return _objectSpread({},v2,{display:displays[v2.model][v2.key]})}):_objectSpread({},value,{display:displays[value.model][value.key]});entity[relationField]=newValue}});case 9:case"end":return _context19.stop()}},_marked19)}function loadData(){var reset,_ref11,entityName,entityId,fieldDefinitions,entity,flattenEntity,formValues,options,_args20=arguments;return regenerator_default.a.wrap(function(_context20){for(;;)switch(_context20.prev=_context20.next){case 0:return reset=!(0<_args20.length&&void 0!==_args20[0])||_args20[0],_context20.next=3,Object(effects.e)(entityDetailSelector);case 3:return _ref11=_context20.sent,entityName=_ref11.entityName,entityId=_ref11.entityId,fieldDefinitions=_ref11.fieldDefinitions,_context20.next=9,Object(effects.b)(loadEntity,entityName,entityId,fieldDefinitions);case 9:return entity=_context20.sent,_context20.next=12,Object(effects.b)(api.a.getFlattenEntity,entity);case 12:return flattenEntity=_context20.sent,_context20.next=15,Object(effects.b)(enhanceEntityWithDisplayExpressions,flattenEntity);case 15:return _context20.next=17,Object(effects.b)(enhanceEntityWithDisplays,flattenEntity);case 17:return _context20.next=19,Object(effects.b)(src_form.a.entityToFormValues,flattenEntity);case 19:return formValues=_context20.sent,options=reset?{}:{keepDirty:!0,keepValues:!1},_context20.next=23,Object(effects.d)(es_actions.a.initialize(FORM_ID,formValues,options));case 23:case"end":return _context20.stop()}},_marked20)}function actionInvoked(action){return regenerator_default.a.wrap(function(_context21){for(;;)switch(_context21.prev=_context21.next){case 0:return _context21.next=2,Object(effects.b)(loadData,!1);case 2:return _context21.next=4,Object(effects.d)(actionEmitter.a.emitAction(action));case 4:case"end":return _context21.stop()}},_marked21)}function navigateToCreate(_ref12){var payload;return regenerator_default.a.wrap(function(_context22){for(;;)switch(_context22.prev=_context22.next){case 0:return payload=_ref12.payload,_context22.next=3,Object(effects.d)(externalEvents.a.fireExternalEvent("onNavigateToCreate",payload.relationName));case 3:case"end":return _context22.stop()}},_marked22)}var entityDetail=function reducer_reducer(){var state=0<arguments.length&&void 0!==arguments[0]?arguments[0]:initialState,action=1<arguments.length?arguments[1]:void 0,handler=ACTION_HANDLERS[action.type];return handler?handler(state,action):state};__webpack_require__.d(__webpack_exports__,"b",function(){return reducers_sagas});__webpack_exports__.a={entityDetail:entityDetail,form:reducer.a};var reducers_sagas=[sagas]}}]);
//# sourceMappingURL=0.44b1bdfc16d6800254d4.bundle.js.map